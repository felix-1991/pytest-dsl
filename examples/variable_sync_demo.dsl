@name: "实时变量同步演示"
@description: "演示在执行DSL语句时实时同步所有上下文变量到远程服务器"
@remote: "http://localhost:8270/" as demo_server

# 设置初始变量
用户名 = "张三"
年龄 = 25
部门 = "技术部"

# 全局变量
g_项目名称 = "pytest-dsl项目"
g_版本号 = "2.0.1"

# 通过关键字获取的变量
当前时间 = [获取当前时间]

# 在远程服务器上执行关键字，应该能访问到上面设置的所有变量
demo_server|[显示用户信息], 用户名: ${用户名}, 年龄: ${年龄}, 部门: ${部门}

# 修改变量后再次执行
年龄 = 26
部门 = "研发部"

# 远程关键字应该能获取到更新后的变量值
demo_server|[显示用户信息], 用户名: ${用户名}, 年龄: ${年龄}, 部门: ${部门}

# 循环中的变量同步
for i in [1, 2, 3] do
    循环计数器 = ${i}
    # 远程关键字应该能获取到当前循环的变量值
    demo_server|[显示循环信息], 计数器: ${循环计数器}, 用户: ${用户名}
end

# 通过远程关键字赋值
服务器时间 = demo_server|[获取服务器时间]

# 验证远程关键字返回的值已正确赋值并同步
demo_server|[验证变量同步], 服务器时间: ${服务器时间}, 项目名称: ${g_项目名称} 